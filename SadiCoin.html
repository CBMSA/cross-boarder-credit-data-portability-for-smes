

<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>SadiCoin Market ‚Äî DApp</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <!-- Bootstrap for basic layout -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Lightweight Charts for candlestick/line charts -->
  <script src="https://unpkg.com/lightweight-charts@4.0.0/dist/lightweight-charts.standalone.production.js"></script>

  <!-- Ethers for wallet + contract calls -->
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>

  <style>
    body { background:#f6f8fb; font-family:Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; }
    .container { max-width:1200px; margin-top:20px; }
    .card { border-radius:12px; box-shadow:0 6px 20px rgba(12,20,40,0.06); }
    .logo { height:40px; }
    .stat { font-weight:600; font-size:1.05rem; }
    #chart { height:380px; }
    .small-muted { font-size:0.85rem; color:#6b7280; }
    .btn-sm-wide { padding-left:1.1rem; padding-right:1.1rem; }
    .tick-up { color:#16a34a; } .tick-down { color:#dc2626; }
  </style>
</head>
<body>
  <div class="container">
    <div class="d-flex align-items-center justify-content-between mb-3">
      <div class="d-flex align-items-center gap-3">
        <img src="https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/polygon/info/logo.png" class="logo" alt="logo">
        <div>
          <h3 class="mb-0">SadiCoin Market</h3>
          <div class="small-muted">Live market, swap & on/off-ramp ‚Äî Dexscreener + QuickSwap (Polygon)</div>
        </div>
      </div>
      <div class="d-flex gap-2 align-items-center">
        <button id="btnAddToken" class="btn btn-outline-secondary btn-sm">+ Add SDC to MetaMask</button>
        <button id="btnAddLP" class="btn btn-outline-secondary btn-sm">+ Watch LP token</button>
        <button id="connectBtn" class="btn btn-primary btn-sm">Connect Wallet</button>
      </div>
    </div>

    <div class="row g-3">
      <!-- Left column: Market Snapshot -->
      <div class="col-lg-4">
        <div class="card p-3 mb-3">
          <h5 class="mb-3">Market Snapshot</h5>
          <div class="mb-3 d-flex justify-content-between">
            <div class="small-muted">Pair</div>
            <div class="stat">SDC / POL</div>
          </div>
          <div class="mb-3 d-flex justify-content-between">
            <div class="small-muted">Price (USD)</div>
            <div id="priceUsd" class="stat">‚Äî</div>
          </div>
          <div class="mb-3 d-flex justify-content-between">
            <div class="small-muted">Price (POL)</div>
            <div id="priceNative" class="stat">‚Äî</div>
          </div>
          <div class="mb-3 d-flex justify-content-between">
            <div class="small-muted">24h Change</div>
            <div id="priceChange" class="stat">‚Äî</div>
          </div>
          <div class="mb-3 d-flex justify-content-between">
            <div class="small-muted">Liquidity (USD)</div>
            <div id="liquidity" class="stat">‚Äî</div>
          </div>
          <div class="mb-3 d-flex justify-content-between">
            <div class="small-muted">Volume (24h)</div>
            <div id="volume" class="stat">‚Äî</div>
          </div>

          <div class="mt-3 d-grid gap-2">
            <button id="swapToPol" class="btn btn-indigo btn-primary btn-sm-wide">Swap SDC ‚Üí POL</button>
            <button id="swapToSdc" class="btn btn-outline-secondary btn-sm-wide">Swap POL ‚Üí SDC</button>
            <a id="addLiquidityBtn" class="btn btn-outline-dark btn-sm-wide" href="#" target="_blank">Add Liquidity</a>
            <a id="openDexscreener" class="btn btn-outline-info btn-sm-wide" href="#" target="_blank">Open on Dexscreener</a>
            <a id="openPolygonscan" class="btn btn-outline-secondary btn-sm-wide" href="#" target="_blank">Open Pair on PolygonScan</a>
          </div>
        </div>

        <div class="card p-3">
          <h6 class="mb-2">Wallet</h6>
          <div class="small-muted mb-2">Connect your MetaMask wallet to see SDC & POL balances</div>
          <div class="mb-2 d-flex justify-content-between">
            <div>Address</div>
            <div id="walletAddr" class="small-muted">Not connected</div>
          </div>
          <div class="mb-2 d-flex justify-content-between">
            <div>SDC Balance</div>
            <div id="sdcBal" class="small-muted">‚Äî</div>
          </div>
          <div class="mb-2 d-flex justify-content-between">
            <div>POL Balance</div>
            <div id="polBal" class="small-muted">‚Äî</div>
          </div>

          <div class="mt-2 d-grid gap-2">
            <button id="refreshBalances" class="btn btn-outline-primary btn-sm">Refresh Balances</button>
          </div>
        </div>
      </div>

      <!-- Right column: Chart + Chart Controls -->
      <div class="col-lg-8">
        <div class="card p-3 mb-3">
          <div class="d-flex justify-content-between align-items-start mb-2">
            <div>
              <h5 class="mb-0">SDC / USD ‚Äî Live Chart</h5>
              <div class="small-muted">Source: Dexscreener ‚Äî updates every 8s</div>
            </div>
            <div class="text-end">
              <div class="small-muted">Pair: <span id="pairAddress" class="fw-semibold">...</span></div>
              <div id="lastUpdated" class="small-muted mt-1">Updated: ‚Äî</div>
            </div>
          </div>

          <div id="chart"></div>
          <div class="mt-3 d-flex gap-2">
            <button id="btnZoomFull" class="btn btn-sm btn-outline-secondary">Zoom Full</button>
            <button id="btnZoomReset" class="btn btn-sm btn-outline-secondary">Reset Zoom</button>
            <div class="ms-auto small-muted" id="pointInfo">‚Äî</div>
          </div>
        </div>

        <div class="card p-3">
          <h6 class="mb-2">Buy / Sell / On-Ramp</h6>
          <div class="row g-2">
            <div class="col-md-4">
              <button id="buyMoonpay" class="btn btn-success w-100">Buy via MoonPay</button>
            </div>
            <div class="col-md-4">
              <button id="buyTransak" class="btn btn-outline-primary w-100">Buy via Transak</button>
            </div>
            <div class="col-md-4">
              <button id="bridgeBtn" class="btn btn-outline-warning w-100">Bridge (Polygon ‚Üí Ethereum)</button>
            </div>
          </div>
          <div class="small-muted mt-2">Note: on/off-ramp integration requires server-side keys for production (do not add secrets to the client)</div>
        </div>
      </div>
    </div>


<!-- SadiCoin Official Info Section -->
<section id="sadicoin-official" style="background:#0b0f19; color:#fff; padding:40px 20px; text-align:center; border-top:2px solid #2dd4bf;">
  <h2 style="font-size:28px; margin-bottom:10px;">ü™ô SadiCoin (SDC) Official Channels</h2>
  <p style="font-size:16px; color:#ccc; margin-bottom:30px;">
    Verified project information and official contact links
  </p>

  <!-- Social Media Links -->
  <div style="margin-bottom:25px;">
    <a href="https://x.com/FaraiMuneri?s=09" target="_blank" style="margin:0 10px; color:#2dd4bf; text-decoration:none;">üê¶ X (Twitter)</a>
    <a href="https://t.me/SadiCoinCommunity" target="_blank" style="margin:0 10px; color:#2dd4bf; text-decoration:none;">üí¨ Telegram</a>
    <a href="https://instagram.com/sadicoin" target="_blank" style="margin:0 10px; color:#2dd4bf; text-decoration:none;">üì∏ Instagram</a>
  </div>

  <!-- Website -->
  <div style="margin-bottom:20px;">
    üåê <a href="https://www.sacreserve.africa" target="_blank" style="color:#fff; text-decoration:underline;">www.sacreserve.africa</a>
  </div>

  <!-- Smart Contract -->
  <div style="margin-bottom:20px;">
    üîó Contract Address: 
    <a href="https://polygonscan.com/token/0x3e6dB8977261B30Ea3Cc0408867912E8B6CeDC96" target="_blank" style="color:#2dd4bf; text-decoration:none;">
      0x3e6dB8977261B30Ea3Cc0408867912E8B6CeDC96
    </a>
  </div>

  <!-- Contact Email -->
  <div style="margin-bottom:20px;">
    üìß Contact Email: 
    <a href="mailto:muchbepvtltd@gmail.com" style="color:#fff; text-decoration:underline;">muchbepvtltd@gmail.com</a>
  </div>

  <!-- Location -->
  <div style="color:#ccc;">
    üìç Based in Polokwane, Limpopo, South Africa  
  </div>

  <hr style="margin:30px auto; width:60%; border-color:#2dd4bf;">

  <p style="font-size:14px; color:#777;">Verification Ticket: <strong>#1292620</strong> | CoinMarketCap Listing Request</p>
</section>



    <footer class="text-center small-muted mt-4 mb-4">¬© 2025 SadiCoin ‚Äî Market</footer>
  </div>

<script>


/* ---------------- CONFIG ---------------- */
const DEXSCREENER_PAIR = '0xB298Eff7ddC6385cdb5494a7315FD11a5fE461c1';
const DEXSCREENER_API = `https://api.dexscreener.com/latest/dex/pairs/polygon/${DEXSCREENER_PAIR}`;
const SDC_ADDRESS = '0x3e6db8977261b30ea3cc0408867912e8b6cedc96';
const POL_NATIVE_ADDRESS = '0x0000000000000000000000000000000000001010'; // Dexscreener uses this for native
const LP_PAIR_ADDRESS = DEXSCREENER_PAIR;
const POLYGONSCAN_PAIR_URL = `https://polygonscan.com/address/${LP_PAIR_ADDRESS}`;
const DEXSCREENER_PAIR_URL = `https://dexscreener.com/polygon/${LP_PAIR_ADDRESS}`;
// On-ramps (replace with your publishable keys or use hosted links)
const MOONPAY_PUBLISHABLE = 'REPLACE_WITH_KEY';
const TRANSAK_LINK = 'https://global.transak.com?apiKey=REPLACE_WITH_KEY';

// ERC20 minimal ABI
const ERC20_MINIMAL = [
  "function name() view returns (string)",
  "function symbol() view returns (string)",
  "function decimals() view returns (uint8)",
  "function balanceOf(address) view returns (uint256)"
];

/* ---------------- STATE ---------------- */
let provider = null;
let signer = null;
let account = null;
let chart = null;
let lineSeries = null;
let chartData = []; // { time: unix, value: number }
let lastUpdate = null;

/* ---------------- UI ELEMENTS ---------------- */
const connectBtn = document.getElementById('connectBtn');
const btnAddToken = document.getElementById('btnAddToken');
const btnAddLP = document.getElementById('btnAddLP');
const walletAddrEl = document.getElementById('walletAddr');
const sdcBalEl = document.getElementById('sdcBal');
const polBalEl = document.getElementById('polBal');

const priceUsdEl = document.getElementById('priceUsd');
const priceNativeEl = document.getElementById('priceNative');
const priceChangeEl = document.getElementById('priceChange');
const liquidityEl = document.getElementById('liquidity');
const volumeEl = document.getElementById('volume');
const lastUpdatedEl = document.getElementById('lastUpdated');

const swapToPolBtn = document.getElementById('swapToPol');
const swapToSdcBtn = document.getElementById('swapToSdc');
const addLiquidityBtn = document.getElementById('addLiquidityBtn');
const openDexscreener = document.getElementById('openDexscreener');
const openPolygonscan = document.getElementById('openPolygonscan');

/* ---------------- Helper functions ---------------- */
function formatUsd(n) {
  if (n === null || n === undefined) return '‚Äî';
  if (n < 0.0001) return Number(n).toExponential(2);
  return new Intl.NumberFormat('en-ZA', { style: 'currency', currency: 'USD', maximumFractionDigits: 6 }).format(n);
}
function short(n) {
  if (n === null || n === undefined) return '‚Äî';
  if (n >= 1e9) return (n/1e9).toFixed(2) + 'B';
  if (n >= 1e6) return (n/1e6).toFixed(2) + 'M';
  if (n >= 1e3) return (n/1e3).toFixed(2) + 'K';
  return Number(n).toFixed(2);
}

/* ---------------- Dexscreener polling & UI update ---------------- */
async function fetchDexscreener() {
  try {
    const res = await fetch(DEXSCREENER_API);
    if (!res.ok) throw new Error('Dexscreener error ' + res.status);
    const json = await res.json();
    const pair = json.pair || json; // API returns pair object
    const priceUsd = pair.priceUsd ? Number(pair.priceUsd) : null;
    const priceNative = pair.priceNative ? Number(pair.priceNative) : null;
    const liquidity = pair.liquidity ? (pair.liquidity.usd || null) : null;
    const volume = pair.volume ? Number(pair.volume) : null;
    const change = pair.priceChange ? pair.priceChange : null;

    // Update UI
    priceUsdEl.innerText = priceUsd ? Number(priceUsd).toFixed(8) : '‚Äî';
    priceNativeEl.innerText = priceNative ? Number(priceNative).toFixed(8) : '‚Äî';
    priceChangeEl.innerText = (change !== null && change !== undefined) ? (Number(change).toFixed(2) + '%') : '‚Äî';
    priceChangeEl.className = 'stat ' + (change >= 0 ? 'tick-up' : 'tick-down');
    liquidityEl.innerText = liquidity ? '$' + Number(liquidity).toLocaleString() : '‚Äî';
    volumeEl.innerText = volume ? '$' + Number(volume).toLocaleString() : '‚Äî';
    lastUpdated = Date.now();
    lastUpdatedEl.innerText = 'Updated: ' + new Date(lastUpdated).toLocaleString();

    // update chart data (append)
    if (priceUsd) {
      const point = { time: Math.floor(Date.now() / 1000), value: Number(priceUsd) };
      chartData.push(point);
      if (chartData.length > 500) chartData.shift();
      if (lineSeries) lineSeries.setData(chartData);
    }

    // links
    openDexscreener.href = DEXSCREENER_PAIR_URL;
    openPolygonscan.href = POLYGONSCAN_PAIR_URL;
    document.getElementById('pairAddress').innerText = LP_PAIR_ADDRESS;
    addLiquidityBtn.href = `https://quickswap.exchange/#/add/${SDC_ADDRESS}/${POL_NATIVE_ADDRESS}`;

  } catch (e) {
    console.error('fetchDexscreener', e);
  }
}

/* ---------------- Chart init ---------------- */
function initChart() {
  const container = document.getElementById('chart');
  container.innerHTML = ''; // clear
  chart = LightweightCharts.createChart(container, {
    width: container.clientWidth,
    height: 380,
    layout: { textColor: '#0f172a', background: { color: '#ffffff' } },
    grid: { vertLines: {visible:false}, horzLines: { color: '#f1f5f9' } }
  });
  lineSeries = chart.addLineSeries({ color: '#0066ff', lineWidth: 2 });
  // responsive
  window.addEventListener('resize', () => chart.applyOptions({ width: container.clientWidth }));
  // tooltip on move
  chart.subscribeCrosshairMove((param) => {
    if (!param || !param.time) {
      document.getElementById('pointInfo').innerText = '‚Äî';
      return;
    }
    const price = param.seriesPrices.get(lineSeries);
    if (price) {
      document.getElementById('pointInfo').innerText = 'Price: $' + Number(price).toFixed(8);
    }
  });
}

/* ---------------- Wallet connect & balances ---------------- */
async function connectWallet() {
  try {
    if (!window.ethereum) {
      alert('MetaMask not found. Please install MetaMask and try again.');
      return;
    }
    provider = new ethers.providers.Web3Provider(window.ethereum, 'any');
    await provider.send('eth_requestAccounts', []);
    signer = provider.getSigner();
    account = await signer.getAddress();
    walletAddrEl.innerText = account;
    connectBtn.innerText = account.slice(0,6) + '...' + account.slice(-4);
    await refreshBalances();
  } catch (e) {
    console.error('connectWallet', e);
    alert('Wallet connect failed: ' + (e.message || e));
  }
}
connectBtn.addEventListener('click', connectWallet);

async function refreshBalances() {
  try {
    if (!account) { alert('Connect wallet first'); return; }
    const sdcContract = new ethers.Contract(SDC_ADDRESS, ERC20_MINIMAL, provider);
    const polContract = new ethers.Contract(POL_NATIVE_ADDRESS, ERC20_MINIMAL, provider).catch(()=>null);
    // POL native balance must be read from provider
    const sdcDecimals = await sdcContract.decimals();
    const sdcRaw = await sdcContract.balanceOf(account);
    const sdcBal = Number(ethers.utils.formatUnits(sdcRaw, sdcDecimals));
    sdcBalEl.innerText = sdcBal.toLocaleString();
    // POL (native) balance:
    const polRaw = await provider.getBalance(account);
    const polBal = Number(ethers.utils.formatEther(polRaw));
    polBalEl.innerText = polBal.toLocaleString();
  } catch (e) {
    console.error('refreshBalances', e);
    sdcBalEl.innerText = 'Error';
    polBalEl.innerText = 'Error';
  }
}

document.getElementById('refreshBalances').addEventListener('click', () => {
  refreshBalances();
});

/* ---------------- Add token / LP watch ---------------- */
btnAddToken.addEventListener('click', async () => {
  if (!window.ethereum) return alert('MetaMask required');
  try {
    await window.ethereum.request({
      method: 'wallet_watchAsset',
      params: {
        type: 'ERC20',
        options: {
          address: SDC_ADDRESS,
          symbol: 'SDC',
          decimals: 18,
          image: 'https://raw.githubusercontent.com/your-org/your-repo/main/sadicoin.png' // replace
        }
      }
    });
    alert('SDC token add requested in MetaMask (confirm in wallet).');
  } catch (e) {
    console.error('add token', e);
    alert('Add token failed');
  }
});

btnAddLP.addEventListener('click', async () => {
  if (!window.ethereum) return alert('MetaMask required');
  try {
    // LP token is ERC20 pair contract - allow watch
    await window.ethereum.request({
      method: 'wallet_watchAsset',
      params: {
        type: 'ERC20',
        options: {
          address: LP_PAIR_ADDRESS,
          symbol: 'SDC-POL-LP',
          decimals: 18,
          image: 'https://raw.githubusercontent.com/your-org/your-repo/main/lp.png' // replace
        }
      }
    });
    alert('LP token add requested in MetaMask.');
  } catch (e) {
    console.error('add lp', e);
    alert('Add LP token failed');
  }
});

/* ---------------- Swap links ---------------- */
swapToPolBtn.addEventListener('click', () => {
  const url = `https://quickswap.exchange/#/swap?inputCurrency=${SDC_ADDRESS}&outputCurrency=${POL_NATIVE_ADDRESS}`;
  window.open(url, '_blank');
});
swapToSdcBtn.addEventListener('click', () => {
  const url = `https://quickswap.exchange/#/swap?inputCurrency=${POL_NATIVE_ADDRESS}&outputCurrency=${SDC_ADDRESS}`;
  window.open(url, '_blank');
});

/* ---------------- On-ramp / Off-ramp actions ---------------- */
document.getElementById('buyMoonpay').addEventListener('click', () => {
  // MoonPay hosted link (replace publishable key)
  const url = new URL('https://buy.moonpay.com');
  url.searchParams.set('apiKey', MOONPAY_PUBLISHABLE);
  url.searchParams.set('currencyCode', 'matic');
  if (account) url.searchParams.set('walletAddress', account);
  window.open(url.toString(), '_blank');
});
document.getElementById('buyTransak').addEventListener('click', () => {
  // Transak link
  window.open(TRANSAK_LINK + (account ? `&walletAddress=${account}` : ''), '_blank');
});
document.getElementById('bridgeBtn').addEventListener('click', () => {
  window.open('https://wallet.polygon.technology/bridge', '_blank');
});

/* ---------------- Init flow ---------------- */
(async function init() {
  // create chart
  initChart();
  // initial data fetch
  await fetchDexscreener();
  // poll every 8 seconds
  setInterval(fetchDexscreener, 8000);
})();
</script>
</body>
</html>



