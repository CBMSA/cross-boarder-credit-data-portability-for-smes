
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Photo Chat - CBM SARB</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"/>
  <style>
    body { font-family: Arial, sans-serif; background-color: #f5f5f5; margin: 0; padding: 0; }
    header { background-color: #003366; color: white; padding: 10px; display: flex; align-items: center; justify-content: space-between; }
    header img { height: 50px; }
    header h1 { font-size: 20px; margin-left: 10px; }
    #video-container { display: flex; justify-content: space-around; padding: 20px; }
    video { width: 45%; border: 2px solid #003366; border-radius: 10px; }
    footer { text-align: center; padding: 15px; background: #003366; color: white; }
    #chatbot { position: fixed; bottom: 0; right: 20px; background: white; width: 300px; border: 1px solid #ccc; border-radius: 10px 10px 0 0; }
    #chatbot-header { background: #003366; color: white; padding: 10px; border-radius: 10px 10px 0 0; }
    #chatbot-body { height: 200px; overflow-y: auto; padding: 10px; }
    #chatbot-input { display: flex; padding: 10px; }
    #chatbot-input input { flex-grow: 1; padding: 5px; }
    #chatbot-input button { margin-left: 5px; }
  </style>
</head>
<body>

<header>
  <div class="d-flex align-items-center">
    <img src="file_00000000968061f89abd9d3d435098f1" alt="Photo Chat Logo">
    <h1> Photo Chat</h1>
  </div>
</header>

<main id="video-container">
  <video id="localVideo" autoplay muted></video>
  <video id="remoteVideo" autoplay></video>
</main>

<!-- Chatbot -->
<div id="chatbot">
  <div id="chatbot-header">AI CiBot</div>
  <div id="chatbot-body">
    <p><strong>CiBot:</strong> Hello! How can I assist you today?</p>
  </div>
  <div id="chatbot-input">
    <input type="text" id="cibot-input" placeholder="Type your message..." />
    <button onclick="sendMessage()">Send</button>
  </div>
</div>

<footer>
  Â© 2025 Photo-Chat | All rights reserved.<br>
  Licensed under MIT License.
</footer>

<script>
  const localVideo = document.getElementById('localVideo');
  const remoteVideo = document.getElementById('remoteVideo');
  const socket = io();

  let localStream;
  let peerConnection;
  const config = { iceServers: [{ urls: 'stun:stun.l.google.com:19302' }] };

  async function initMedia() {
    try {
      localStream = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });
      localVideo.srcObject = localStream;
      socket.emit('join');
    } catch (e) {
      console.error('Media access denied', e);
    }
  }

  socket.on('offer', async (offer) => {
    peerConnection = new RTCPeerConnection(config);
    localStream.getTracks().forEach(track => peerConnection.addTrack(track, localStream));

    peerConnection.ontrack = (event) => {
      remoteVideo.srcObject = event.streams[0];
    };

    await peerConnection.setRemoteDescription(new RTCSessionDescription(offer));
    const answer = await peerConnection.createAnswer();
    await peerConnection.setLocalDescription(answer);
    socket.emit('answer', answer);

    peerConnection.onicecandidate = event => {
      if (event.candidate) {
        socket.emit('candidate', event.candidate);
      }
    };
  });

  socket.on('answer', async (answer) => {
    await peerConnection.setRemoteDescription(new RTCSessionDescription(answer));
  });

  socket.on('candidate', (candidate) => {
    peerConnection.addIceCandidate(new RTCIceCandidate(candidate));
  });

  socket.on('ready', async () => {
    peerConnection = new RTCPeerConnection(config);
    localStream.getTracks().forEach(track => peerConnection.addTrack(track, localStream));

    peerConnection.ontrack = (event) => {
      remoteVideo.srcObject = event.streams[0];
    };

    const offer = await peerConnection.createOffer();
    await peerConnection.setLocalDescription(offer);
    socket.emit('offer', offer);

    peerConnection.onicecandidate = event => {
      if (event.candidate) {
        socket.emit('candidate', event.candidate);
      }
    };
  });

  function sendMessage() {
    const input = document.getElementById('cibot-input');
    const message = input.value.trim();
    if (message) {
      const body = document.getElementById('chatbot-body');
      body.innerHTML += `<p><strong>You:</strong> ${message}</p>`;
      // Basic AI Bot
      setTimeout(() => {
        body.innerHTML += `<p><strong>CiBot:</strong> Thank you for your message. I will get back to you soon.</p>`;
        body.scrollTop = body.scrollHeight;
      }, 1000);
      input.value = '';
    }
  }

  initMedia();
</script>

<script src="/socket.io/socket.io.js"></script>
</body>
</html>




