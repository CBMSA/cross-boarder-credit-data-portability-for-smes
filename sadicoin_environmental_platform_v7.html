<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<title>SadiCoin Tech ‚Äì Environmental & SAR Intelligence (V7.0)</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>

<!-- Leaflet -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<!-- jsPDF -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
body{margin:0;font-family:Arial;background:#0b0f1a;color:#fff}
header{padding:12px;background:#11162a;text-align:center;font-weight:bold}
#map{height:55vh}
.panel{padding:12px;background:#161c33;margin:6px}
button{padding:6px 12px;border:none;border-radius:4px;cursor:pointer}
input,select{padding:5px}
.good{color:#4caf50}
.warn{color:#ff9800}
.bad{color:#f44336}
video,img{max-width:100%;border-radius:6px;margin-top:6px}
</style>
</head>

<body>

<header>üåç SadiCoin Tech ‚Äî Environmental + Search & Rescue Intelligence (V7.0)</header>

<div id="map"></div>

<div class="panel">
<b>üì° Satellite Sources</b><br>
‚Ä¢ NASA GIBS (True Color)<br>
‚Ä¢ NASA EONET (Live disasters)<br>
‚Ä¢ Sentinel-1 SAR (Floods, terrain, debris, landslides)<br>
</div>

<div class="panel">
<b>üÜò Search & Rescue ‚Äì Manual Scan</b><br><br>

<button onclick="startCamera()">üì∑ Start Camera Scan (Manual)</button>
<button onclick="stopCamera()">‚èπ Stop</button><br>
<video id="camera" autoplay playsinline></video>

<hr>

<label><b>üì§ Upload Thermal / SAR Image</b></label><br>
<input type="file" accept="image/*" onchange="loadAnomaly(event)"/>
<img id="thermalPreview"/>

<hr>

<label>Confidence Level</label><br>
<select id="confidence">
  <option>Low</option>
  <option>Medium</option>
  <option>High</option>
</select><br><br>

<button onclick="markAnomaly()">‚ö†Ô∏è Mark Possible Human Presence (Unverified)</button>

<p class="warn">
‚ö†Ô∏è This system does NOT identify people or bodies.<br>
Markers indicate <b>possible human presence</b> only and require SAR review.
</p>
</div>

<div class="panel">
<b>üìã SAR Review Workflow</b><br>
<textarea id="reviewNotes" placeholder="SAR reviewer notes‚Ä¶" style="width:100%;height:60px"></textarea><br>
<button onclick="exportSAR()">üìÑ Export SAR Brief (PDF)</button>
</div>

<div class="panel">
<b>üìà Hazard Trends</b>
<canvas id="trendChart" height="120"></canvas>
</div>

<script>
// ================= MAP =================
const map = L.map('map').setView([0,0],2);

// NASA GIBS
L.tileLayer(
 "https://gibs.earthdata.nasa.gov/wmts/epsg3857/best/MODIS_Terra_CorrectedReflectance_TrueColor/default/2024-01-01/GoogleMapsCompatible_Level9/{z}/{y}/{x}.jpg",
 {maxZoom:9, attribution:"NASA GIBS"}
).addTo(map);

let sarLayer = L.layerGroup().addTo(map);

// ================= CAMERA =================
let stream=null;
async function startCamera(){
  try{
    stream = await navigator.mediaDevices.getUserMedia({video:true});
    document.getElementById("camera").srcObject = stream;
  }catch(e){
    alert("Camera permission required");
  }
}
function stopCamera(){
  if(stream){
    stream.getTracks().forEach(t=>t.stop());
    document.getElementById("camera").srcObject=null;
  }
}

// ================= ANOMALY UPLOAD =================
let uploadedImage=null;
function loadAnomaly(e){
  const file=e.target.files[0];
  const reader=new FileReader();
  reader.onload=()=>{
    uploadedImage=reader.result;
    document.getElementById("thermalPreview").src=uploadedImage;
  };
  reader.readAsDataURL(file);
}

// ================= MARK ANOMALY =================
function markAnomaly(){
  map.once('click', e=>{
    const conf=document.getElementById("confidence").value;
    L.circleMarker(e.latlng,{
      radius:8,
      color: conf==="High"?"red":conf==="Medium"?"orange":"yellow"
    }).addTo(sarLayer)
    .bindPopup(
      `<b>Possible Human Presence (Unverified)</b><br>
       Confidence: ${conf}<br>
       Requires SAR confirmation`
    );
  });
  alert("Click on map to place unverified marker");
}

// ================= PDF EXPORT =================
function exportSAR(){
  const {jsPDF}=window.jspdf;
  const pdf=new jsPDF();
  pdf.text("SadiCoin Tech ‚Äì SAR Review Brief",10,10);
  pdf.text("This report contains unverified anomaly markers.",10,20);
  pdf.text("No identification or conclusions are made.",10,30);
  pdf.text("Reviewer Notes:",10,45);
  pdf.text(document.getElementById("reviewNotes").value || "None",10,55,{maxWidth:180});
  pdf.save("SAR_Brief.pdf");
}

// ================= TRENDS =================
const ctx=document.getElementById("trendChart").getContext("2d");
new Chart(ctx,{
  type:"line",
  data:{
    labels:["Jan","Feb","Mar","Apr","May","Jun"],
    datasets:[
      {label:"Floods",data:[4,6,9,7,10,12],borderColor:"blue"},
      {label:"Fires",data:[3,5,4,6,8,9],borderColor:"red"}
    ]
  }
});
</script>

<!-- ================= EARTH ENGINE (REFERENCE) ================= -->
<!--
PROFESSIONAL SENTINEL-1 SAR (Google Earth Engine)

var s1 = ee.ImageCollection('COPERNICUS/S1_GRD')
  .filterBounds(ee.Geometry.Point([lon, lat]))
  .filterDate('2024-01-01','2024-01-31')
  .filter(ee.Filter.eq('instrumentMode','IW'))
  .filter(ee.Filter.listContains('transmitterReceiverPolarisation','VV'))
  .select('VV');

var flood = s1.mean().lt(-17);
Export.table.toDrive({
  collection: flood.reduceToVectors({
    geometry: region,
    scale: 30
  }),
  fileFormat: 'GeoJSON'
});
-->

</body>
</html>