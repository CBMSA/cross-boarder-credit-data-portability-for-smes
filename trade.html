
<!DOCTYPE html>
<html>
<head>
    <title>SADIcoin Admin Portal</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background: #f8f9fa; }
        #sidebar { min-width: 220px; height: 100vh; background: #343a40; color: #fff; }
        #sidebar .nav-link { color: #fff; }
        #sidebar .nav-link.active { background: #495057; }
        #content { margin-left: 230px; padding: 20px; }
        .dashboard-card { min-width: 200px; }
    </style>
</head>
<body>

     <header class="d-flex align-items-center justify-content-between mb-4">
    <img src="ChatGPT Image Sep 11, 2025, 03_15_36 PM.png" alt="SCB Logo" class="logo">
    <h3>SADC Wallet</h3>
  </header>
    
<div class="d-flex">
    <nav id="sidebar" class="flex-column p-3">
        <h3 class="mb-4">SADIcoin Admin</h3>
        <a href="#" class="nav-link active" onclick="showPage('dashboard')">Dashboard</a>
        <a href="#" class="nav-link" onclick="showPage('users')">Users</a>
        <a href="#" class="nav-link" onclick="showPage('transactions')">Transactions</a>
        <a href="#" class="nav-link" onclick="showPage('blocks')">Blocks</a>
        <a href="#" class="nav-link" onclick="showPage('settings')">Settings</a>
    </nav>
    <div id="content" class="flex-grow-1">
        <!-- Dashboard Page -->
        <div id="dashboardPage">
            <h2>Dashboard</h2>
            <div class="d-flex gap-3 flex-wrap mb-4">
                <div class="card dashboard-card">
                    <div class="card-body">
                        <h5 class="card-title">Total Supply</h5>
                        <p id="totalSupply" class="card-text">0</p>
                    </div>
                </div>
                <div class="card dashboard-card">
                    <div class="card-body">
                        <h5 class="card-title">Transactions</h5>
                        <p id="totalTx" class="card-text">0</p>
                    </div>
                </div>
                <div class="card dashboard-card">
                    <div class="card-body">
                        <h5 class="card-title">Wallets</h5>
                        <p id="totalWallets" class="card-text">0</p>
                    </div>
                </div>
            </div>
            <h4>Recent Activity</h4>
            <ul id="recentActivity" class="list-group"></ul>
        </div>

        <!-- Users Page -->
        <div id="usersPage" style="display:none;">
            <h2>Users</h2>
            <table class="table table-bordered">
                <thead>
                    <tr><th>Name</th><th>Email</th><th>Wallet</th><th>Balance</th><th>Status</th></tr>
                </thead>
                <tbody id="usersTable"></tbody>
            </table>
        </div>

        <!-- Transactions Page -->
        <div id="transactionsPage" style="display:none;">
            <h2>Transactions</h2>
            <table class="table table-bordered">
                <thead>
                    <tr><th>ID</th><th>Sender</th><th>Receiver</th><th>Amount</th><th>Status</th><th>Timestamp</th></tr>
                </thead>
                <tbody id="txTable"></tbody>
            </table>
        </div>

        <!-- Blocks Page -->
        <div id="blocksPage" style="display:none;">
            <h2>Blocks</h2>
            <table class="table table-bordered">
                <thead>
                    <tr><th>Block #</th><th>Hash</th><th>Tx Count</th><th>Timestamp</th></tr>
                </thead>
                <tbody id="blocksTable"></tbody>
            </table>
        </div>

        <!-- Settings Page -->
        <div id="settingsPage" style="display:none;">
            <h2>Settings</h2>
            <label>API Key</label>
            <input id="apiKey" type="text" class="form-control mb-2" placeholder="Enter API Key">
            <label>API Secret</label>
            <input id="apiSecret" type="password" class="form-control mb-2" placeholder="Enter API Secret">
            <button class="btn btn-danger mb-2" onclick="pauseNetwork()">Pause Network</button>
            <button class="btn btn-secondary mb-2" onclick="showApiKey()">Show API Key</button>
            <div id="apiKeyBox" style="display:none;">
                <input type="text" class="form-control" readonly>
            </div>
        </div>
    </div>
</div>
<script>
    const API_BASE = "https://broker-api.sandbox.alpaca.markets"; // Example sandbox

    function getAuthHeaders() {
        const key = document.getElementById('apiKey').value.trim();
        const secret = document.getElementById('apiSecret').value.trim();
        return {
            'APCA-API-KEY-ID': key,
            'APCA-API-SECRET-KEY': secret
        };
    }

    // Navigation
    function showPage(page) {
        ['dashboardPage','usersPage','transactionsPage','blocksPage','settingsPage'].forEach(p=>{
            document.getElementById(p).style.display = (p === page+'Page') ? '' : 'none';
        });
        Array.from(document.querySelectorAll('#sidebar .nav-link')).forEach(link => {
            link.classList.remove('active');
        });
        let navs = {dashboard:'Dashboard', users:'Users', transactions:'Transactions', blocks:'Blocks', settings:'Settings'};
        Array.from(document.querySelectorAll('#sidebar .nav-link')).forEach(link=>{
            if(link.innerText===navs[page]) link.classList.add('active');
        });
    }

    // Example: Fetch account info with API keys
    async function loadDashboard() {
        try {
            const res = await fetch(`${API_BASE}/v1/accounts`, {
                headers: getAuthHeaders()
            });
            const data = await res.json();

            document.getElementById('totalSupply').innerText = "Sandbox";
            document.getElementById('totalTx').innerText = data.status;
            document.getElementById('totalWallets').innerText = data.account_number;

            let ul = document.getElementById('recentActivity');
            ul.innerHTML = `<li class="list-group-item">ID: ${data.id}</li>`;
        } catch (err) {
            console.error(err);
            alert("Failed to fetch account: " + err);
        }
    }

    // Settings
    function pauseNetwork() {
        alert("Network paused (API call would go here)");
    }
    function showApiKey() {
        document.getElementById('apiKeyBox').style.display = '';
        document.querySelector('#apiKeyBox input').value = document.getElementById('apiKey').value;
    }

    // Initial load
    window.onload = function() {
        showPage('dashboard');
        loadDashboard();
    };
</script>
</body>
</html>



<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Sadicoin Treasures Wallet</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <script src="https://cdn.jsdelivr.net/npm/ethers@6/dist/ethers.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    body{font-family:Segoe UI;padding:20px;background:#f9f9f9}
    .logo{height:60px}
  </style>
</head>
<body>
  <header class="d-flex align-items-center justify-content-between mb-4">
    <img src="ChatGPT Image Sep 11, 2025, 03_15_36 PM.png" alt="SCB Logo" class="logo">
    <h3>SADC Wallet - Web3</h3>
  </header>

  <nav class="mb-4">
    <button id="connectBtn" class="btn btn-primary">Connect Wallet</button>
    <span id="account" class="ms-3 text-monospace"></span>
  </nav>

  <div id="app" style="display:none;">
    <div class="card p-3 mb-3">
      <h5>Your SADI Balance</h5>
      <p id="tokenBalance">-</p>
      <p id="nativeBalance">-</p>
    </div>

    <div class="card p-3 mb-3">
      <h5>Transfer SADI</h5>
      <input id="to" class="form-control mb-2" placeholder="Recipient address"/>
      <input id="amount" type="number" class="form-control mb-2" placeholder="Amount (SADI)"/>
      <button id="sendBtn" class="btn btn-success w-100">Send</button>
      <div id="txStatus" class="mt-2"></div>
      <div id="qr"></div>
    </div>

    <div class="card p-3 mb-3">
      <h5>Market Data</h5>
      <button id="priceBtn" class="btn btn-outline-primary mb-2">Get 1 SADI → ZAR (CoinMarketCap)</button>
      <div id="cmcResult"></div>
      <button id="ratesBtn" class="btn btn-outline-secondary mt-2">Get Live Exchange Rates</button>
      <div id="ratesResult"></div>
    </div>

    <div class="card p-3 mb-3">
      <h5>MoonPay Swap (overlay)</h5>
      <input id="mp_from" class="form-control mb-2" placeholder="From (e.g. SADI)"/>
      <input id="mp_to" class="form-control mb-2" placeholder="To (e.g. USD)"/>
      <input id="mp_amount" type="number" class="form-control mb-2" placeholder="Amount"/>
      <button id="mp_btn" class="btn btn-warning w-100">Open MoonPay (publishable key used client-side)</button>
    </div>
  </div>

  <footer class="mt-5 text-center">
    <p>&copy; 2025 SCB - SadiCoin</p>
  </footer>

<script>
/* --------- CONFIG (fill after deployment) ----------
   Replace with your deployed contract address and chain id (e.g., 137 = Polygon, 80001 = Mumbai)
   This script expects server endpoints:
     GET /api/cmc-price  -> returns { priceZAR: number, symbol: "SADI" }
     GET /api/rates     -> returns { rates: { USDZAR: x, ... } }
   Server will use your API keys from .env
*/
const CONFIG = {
  CONTRACT_ADDRESS: "REPLACE_WITH_DEPLOYED_CONTRACT_ADDRESS",
  CHAIN_ID: 80001, // example: Mumbai testnet
  TOKEN_DECIMALS: 18,
  MOONPAY_PUBLISHABLE: "pk_live_0UYBzlsyM4A3Adj47IQrOkRx6dCWB4k" // public key - ok client-side
};
/* -------------------------------------------------- */

let provider, signer, account;
const tokenAbi = [
  "function name() view returns (string)",
  "function symbol() view returns (string)",
  "function decimals() view returns (uint8)",
  "function balanceOf(address) view returns (uint256)",
  "function transfer(address to, uint256 amount) returns (bool)",
  "event Transfer(address indexed from, address indexed to, uint256 value)"
];

async function init() {
  const connectBtn = document.getElementById('connectBtn');
  connectBtn.onclick = connectWallet;

  document.getElementById('sendBtn').onclick = sendToken;
  document.getElementById('priceBtn').onclick = getCmcPrice;
  document.getElementById('ratesBtn').onclick = getRates;
  document.getElementById('mp_btn').onclick = openMoonPay;
}

async function connectWallet(){
  if (!window.ethereum) return alert("Please install MetaMask or another injected wallet.");
  provider = new ethers.BrowserProvider(window.ethereum);
  await provider.send("eth_requestAccounts", []);
  signer = await provider.getSigner();
  account = await signer.getAddress();
  document.getElementById('account').innerText = account;
  document.getElementById('app').style.display = 'block';
  refreshBalances();
}

async function refreshBalances(){
  // native balance
  const bal = await provider.getBalance(account);
  document.getElementById('nativeBalance').innerText = `Native: ${ethers.formatEther(bal)} ETH (or native)`;

  // token balance
  const token = new ethers.Contract(CONFIG.CONTRACT_ADDRESS, tokenAbi, provider);
  const raw = await token.balanceOf(account);
  const decimals = CONFIG.TOKEN_DECIMALS;
  const human = Number(ethers.formatUnits(raw, decimals));
  document.getElementById('tokenBalance').innerText = `${human.toLocaleString()} SADI`;
}

async function sendToken(){
  const to = document.getElementById('to').value.trim();
  const amount = Number(document.getElementById('amount').value);
  if (!ethers.isAddress(to)) return alert("Invalid recipient address");
  if (!amount || amount <= 0) return alert("Invalid amount");

  const tokenWithSigner = new ethers.Contract(CONFIG.CONTRACT_ADDRESS, tokenAbi, signer);
  const decimals = CONFIG.TOKEN_DECIMALS;
  const amountUnits = ethers.parseUnits(amount.toString(), decimals);

  try {
    const tx = await tokenWithSigner.transfer(to, amountUnits);
    document.getElementById('txStatus').innerText = `Tx sent: ${tx.hash}. Waiting for confirmation...`;
    const receipt = await tx.wait();
    document.getElementById('txStatus').innerText = `Tx confirmed: ${receipt.transactionHash}`;
    document.getElementById('qr').innerHTML = "";
    new QRCode(document.getElementById('qr'), receipt.transactionHash);
    refreshBalances();
  } catch (err) {
    console.error(err);
    alert("Transfer failed: " + (err?.message || err));
  }
}

/* Market endpoints (server) */
async function getCmcPrice(){
  const res = await fetch('/api/cmc-price');
  if (!res.ok) return alert('Price request failed');
  const js = await res.json();
  document.getElementById('cmcResult').innerText = `1 SADI = ZAR ${js.priceZAR}`;
}

async function getRates(){
  const res = await fetch('/api/rates');
  if (!res.ok) return alert('Rates request failed');
  const js = await res.json();
  const container = document.getElementById('ratesResult');
  container.innerHTML = '';
  Object.entries(js.rates || {}).forEach(([k,v]) => {
    const p = document.createElement('p');
    p.innerText = `${k}: ${v}`;
    container.appendChild(p);
  });
}

/* MoonPay overlay — uses publishable key */
async function openMoonPay(){
  const from = document.getElementById('mp_from').value.trim().toUpperCase();
  const to = document.getElementById('mp_to').value.trim().toUpperCase();
  const amt = document.getElementById('mp_amount').value;
  if (!from || !to || !amt) return alert("Enter from/to/amount");

  // load MoonPay sdk
  const script = document.createElement('script');
  script.src = "https://buy.moonpay.com/js/sdk/latest.js";
  script.onload = () => {
    try {
      const MoonPay = window.MoonPay;
      const inst = new MoonPay({
        apiKey: CONFIG.MOONPAY_PUBLISHABLE,
        environment: 'production',
        flow: 'swap',
        variant: 'overlay',
        params: {
          baseCurrencyCode: from,
          baseCurrencyAmount: amt,
          defaultCurrencyCode: to
        }
      });
      inst.show();
    } catch(e) {
      console.error(e);
      alert("MoonPay failed to open.");
    }
  };
  script.onerror = () => alert("Could not load MoonPay SDK.");
  document.body.appendChild(script);
}

init();
</script>
</body>
</html>

